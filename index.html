<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Тест для экзамена</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Подключение Fuse.js -->
    <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
</head>
<body>

    <!-- Сине-голубой прямоугольник с текстом -->
    <div class="header">
        Стоматология, 3 курс
    </div>

    <div class="container">
        <div class="main-content">
            <!-- Контейнер для вопросов -->
            <div class="questions-container">
                <h1>Тест для экзамена</h1>
                <form id="testForm">
                    <!-- Вопросы будут динамически добавлены из JSON -->
                </form>

                <!-- Выводим результат проверки -->
                <div id="result"></div>
            </div>

            <!-- Контейнер для строки поиска -->
            <div class="search-container">
                <!-- Поле для поиска -->
                <input type="text" id="transparentSearch" placeholder="Введите вопрос..." />

                <!-- Результат поиска -->
                <div id="resultBox" class="hidden">
                    Ответ: <span id="answer"></span>
                </div>
            </div>
        </div>
    </div>

    <!-- Подключение скрипта -->
    <script>
        // Загружаем JSON с вопросами
        fetch('questions.json')
            .then(response => response.json())
            .then(data => {
                const form = document.getElementById('testForm');
                const fuse = new Fuse(data, {
                    keys: ['question'], // Настройка поиска
                    threshold: 0.3 // Порог совпадения
                });

                // Динамическое добавление вопросов в форму
                data.forEach((item, index) => {
                    const questionDiv = document.createElement('div');
                    questionDiv.classList.add('question');

                    questionDiv.innerHTML = `
                        <p>${item.question}</p>
                        ${item.answers.map((answer, i) => `
                            <label>
                                <input type="radio" name="q${index}" value="${String.fromCharCode(65 + i)}">
                                ${answer}
                            </label><br>
                        `).join('')}
                    `;
                    form.appendChild(questionDiv);
                });

                // Проверка результатов
                document.getElementById('submitBtn').addEventListener('click', () => {
                    let score = 0;
                    data.forEach((item, index) => {
                        const selected = form.querySelector(`input[name="q${index}"]:checked`);
                        if (selected && selected.value === item.correct[0]) {
                            score++;
                        }
                    });
                    document.getElementById('result').textContent = `Вы набрали ${score} из ${data.length} баллов.`;
                });

                // Обработка строки поиска
                document.getElementById("transparentSearch").addEventListener("input", (event) => {
                    const query = event.target.value.trim();
                    const resultBox = document.getElementById("resultBox");
                    const answerBox = document.getElementById("answer");

                    if (query.length > 0) {
                        const result = fuse.search(query);
                        if (result.length > 0) {
                            answerBox.textContent = result[0].item.correct;
                        } else {
                            answerBox.textContent = "Ответ не найден";
                        }
                        resultBox.classList.remove("hidden");
                        resultBox.classList.add("visible");
                    } else {
                        resultBox.classList.remove("visible");
                        resultBox.classList.add("hidden");
                        answerBox.textContent = "";
                    }
                });
            })
            .catch(error => console.error('Ошибка загрузки JSON:', error));
    </script>
</body>
</html>
